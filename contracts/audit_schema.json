{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Audit Log Schema",
    "description": "Schema for audit trails of policy processing and clarification",
    "type": "object",
    "properties": {
        "event_id": {
            "type": "string",
            "description": "Unique ID for the audit event"
        },
        "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp of the event"
        },
        "event_type": {
            "type": "string",
            "enum": [
                "POLICY_UPLOAD",
                "RULE_EXTRACTION",
                "AMBIGUITY_DETECTED",
                "CLARIFICATION_RECEIVED",
                "SYNC_TO_BACKEND"
            ],
            "description": "Type of event"
        },
        "policy_id": {
            "type": "string",
            "description": "Related policy ID"
        },
        "user_id": {
            "type": "string",
            "description": "ID of the user who triggered the event (if applicable)"
        },
        "details": {
            "type": "object",
            "description": "Additional context (e.g., specific rule_id clarified, fields changed)",
            "additionalProperties": true
        }
    },
    "required": [
        "event_id",
        "timestamp",
        "event_type",
        "policy_id"
    ]
}